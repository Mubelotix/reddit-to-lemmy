// {"operationName":"CommentsPageAdPost","variables":{"id":"t3_1idlf9a","count":1,"includeAwards":true,"includeEconPromos":false,"feedContext":{"isFullBleed":false},"adContextInput":{"distance":null,"layout":"CARD","deviceAdId":"871986d3-16ac-4ea8-b0be-569cebf340b2","clientSignalSessionData":{"adsSeenCount":5,"totalPostsSeenCount":47,"sessionStartTime":"2025-01-30T15:31:54.079"},"feedSlotIndexData":{},"forceAds":{}},"includePostStats":false,"includeCurrentUserAwards":false,"includeStillMediaAltText":false,"includeMediaAuth":false,"includeNewPixelTrackingFields":true,"includeExcludedExperimentsField":true,"includeExtendedVideoAsset":false,"adEligibilityInput":{"postAdEligibility":"ELIGIBLE","userAdEligi{"operationName":"CommentsPageAdPost","variables":{"id":"t3_1idlf9a","count":1,"includeAwards":true,"includeEconPromos":false,"feedContext":{"isFullBleed":false},"adContextInput"bility":"NOT_ELIGIBLE_AD_LOAD","expiresAt":"2025-01-30T15:47:00.486"}},"extensions":{"persistedQuery":{"version":1,"sha256Hash":"d56e6eee9b7e9e639b8e746e08735f93a0bc031208ed0307461de76d0cf26eb5"}}}
// 
// {"data":{"children":{"__typename":"SubredditPost","id":"t3_1idlf9a","commentsPageAds":[{"__typename":"AdPost","id":"t3_7w17su","createdAt":"2018-02-08T01:26:24.941000+0000","editedAt":null,"postTitle":"Interested in gaining a new perspective on things? Check out the r/askreddit subreddit!","url":"http://www.reddit.com/r/askreddit","content":null,"domain":"reddit.com","isSpoiler":false,"isNsfw":false,"isCommercialCommunication":false,"isLocked":true,"isSaved":false,"isReactAllowed":false,"isHidden":false,"isGildable":false,"isCrosspostable":false,"isScoreHidden":true,"isArchived":false,"isStickied":false,"isPollIncluded":false,"poll":null,"isFollowed":false,"awardings":[],"isContestMode":false,"distinguishedAs":null,"voteState":"NONE","score":null,"commentCount":0.0,"viewCount":null,"authorFlair":null,"flair":null,"authorInfo":{"__typename":"Redditor","id":"t2_1ed7b","name":"redditads","isCakeDayNow":false,"newIcon":{"__typename":"MediaSource","url":"https://styles.redditmedia.com/t5_3rycy/styles/profileIcon_8b4k69583rm61.jpg?width=256\u0026height=256\u0026frame=1\u0026auto=webp\u0026crop=256:256,smart\u0026s=76bac182b146ecb1af8cd08ff77cf6871fafbb59","dimensions":{"width":256,"height":256}},"iconSmall":{"__typename":"MediaSource","url":"https://styles.redditmedia.com/t5_3rycy/styles/profileIcon_8b4k69583rm61.jpg?width=50\u0026height=50\u0026frame=1\u0026auto=webp\u0026crop=50:50,smart\u0026s=e7f385b6498ef0e92c7c14dd2ecf6e9290f31685","dimensions":{"width":50,"height":50}},"snoovatarIcon":null,"profile":{"isNsfw":false},"accountType":null},"isThumbnailEnabled":true,"thumbnail":{"__typename":"MediaSource","url":"https://a.thumbs.redditmedia.com/bcDiRhb3sRzKwj_-Dmo_JYhhM7lwipju11VLlURA8n8.jpg","dimensions":{"width":140,"height":140}},"media":{"__typename":"Media","previewMediaId":"tYcca__B981Md52bBlfvfdo-MlQiCaKlQY9HNUmxlkw","still":{"__typename":"StillMedia","source":{"__typename":"MediaSource","url":"https://external-preview.redd.it/X3dq7BwWSNeUHhYVAwg9EWZnzdW0rDaEwG8X76Th8PI.jpg?auto=webp\u0026s=41609c39ac55f81573d212eaf4cf408bb74a3170","dimensions":{"width":256,"height":256}},"small":{"__typename":"MediaSource","url":"https://external-preview.redd.it/X3dq7BwWSNeUHhYVAwg9EWZnzdW0rDaEwG8X76Th8PI.jpg?width=108\u0026crop=smart\u0026auto=webp\u0026s=eaab9a1dc57aa2e3edfeb2ce2c4b9e3eedd3da34","dimensions":{"width":108,"height":108}},"medium":{"__typename":"MediaSource","url":"https://external-preview.redd.it/X3dq7BwWSNeUHhYVAwg9EWZnzdW0rDaEwG8X76Th8PI.jpg?width=216\u0026crop=smart\u0026auto=webp\u0026s=8307239f0452549dfeb0eb1addf72e8b3e2cee14","dimensions":{"width":216,"height":216}},"large":null,"xlarge":null,"xxlarge":null,"xxxlarge":null},"obfuscated_still":{"__typename":"StillMedia","source":null,"small":null,"medium":null,"large":null,"xlarge":null,"xxlarge":null,"xxxlarge":null},"animated":null,"streaming":null,"video":null,"packagedMedia":null,"typeHint":null,"download":null},"moderationInfo":null,"suggestedCommentSort":"QA","permalink":"/user/redditads/comments/7w17su/interested_in_gaining_a_new_perspective_on_things/","isSelfPost":false,"postHint":"LINK","postEventInfo":null,"gallery":null,"profile":{"__typename":"Profile","redditorInfo":{"__typename":"Redditor","id":"t2_1ed7b","name":"redditads","prefixedName":"u/redditads","accountType":null},"id":"t5_3rycy","title":"Reddit Ads","description":{"markdown":""},"subscribersCount":0,"isNsfw":false,"isSubscribed":false,"isModeratable":false,"modPermissions":null,"whitelistStatus":"NO_ADS","isDefaultIcon":false,"name":"u_redditads","isQuarantined":false,"styles":{"icon":"https://styles.redditmedia.com/t5_3rycy/styles/profileIcon_8b4k69583rm61.jpg?width=256\u0026height=256\u0026frame=1\u0026auto=webp\u0026crop=256:256,smart\u0026s=76bac182b146ecb1af8cd08ff77cf6871fafbb59","legacyIcon":{"__typename":"MediaSource","url":"https://styles.redditmedia.com/t5_3rycy/styles/profileIcon_8b4k69583rm61.jpg?width=256\u0026height=256\u0026frame=1\u0026auto=webp\u0026crop=256:256,smart\u0026s=76bac182b146ecb1af8cd08ff77cf6871fafbb59","dimensions":{"width":256,"height":256}},"legacyPrimaryColor":null}},"callToAction":null,"subcaption":null,"subcaptionStrikethrough":null,"ctaMediaColor":null,"isBlank":true,"outboundLink":{"url":null,"expiresAt":null},"impressionId":"1","adEvents":[],"encryptedTrackingPayload":null,"additionalEventMetadata":null,"isCreatedFromAdsUi":true,"isSurveyAd":false,"promoLayout":null,"appStoreInfo":null,"adSupplementaryTextRichtext":null,"leadGenerationInformation":null,"campaign":null,"isInAppBrowserOverride":false,"adUserTargeting":null,"nextCommentsPageAdEligibility":"ELIGIBLE","excludedExperiments":null,"upvoteRatio":0.2317310026705511,"reactedFrom":null,"attributionInfo":null,"crowdControlLevel":"OFF","isCrowdControlFilterEnabled":false,"languageCode":"en","isTranslatable":false,"isTranslated":false,"translatedLanguage":null,"removedByCategory":null,"promotedCommunityPost":null}]}}}

use actix_web::{web::Json, HttpResponse};
use serde::Deserialize;
use serde_json::json;
use log::debug;

use crate::GraphQl;

#[derive(Deserialize, Debug)]
pub struct GetCommentsPageAdVariables {
    id: String,
}

pub async fn get_comments_page_ad(body: Json<GraphQl<GetCommentsPageAdVariables>>) -> HttpResponse {
    debug!("get_comments_page_ad: {:?}", body.variables);

    let rep = json! {{
        "data": {
            "children": {
                "__typename": "SubredditPost",
                "id": body.variables.id,
                "commentsPageAds": []
            }
        }
    }};

    HttpResponse::Ok().json(rep)
}
